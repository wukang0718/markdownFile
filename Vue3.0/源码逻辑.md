## ref 方法

```typescript
export function ref(value?: unknown) {
  return createRef(value)
}
```

调用 `createRef` 方法

### createRef 方法

判断如果已经是 `ref` 对象，直接返回这个对象

否则，返回一个 `RefImpl` 类型的实例

```typescript
function createRef(rawValue: unknown, shallow = false) {
  if (isRef(rawValue)) { // 判断是否已经是 ref 对象
    return rawValue
  }
  return new RefImpl(rawValue, shallow)
}
```

### RefImpl 类

| 属性      | 描述                                                    |
| --------- | ------------------------------------------------------- |
| _value    | 原始值                                                  |
| __v_isRef | ref 对象的表示，在判断对象是不是 ref 对象的时候，会用到 |
| _rawValue | 原始值                                                  |
| _shallow  | 是否只做浅层的监听                                      |



```typescript
class RefImpl<T> {
  private _value: T

  public readonly __v_isRef = true

  constructor(private _rawValue: T, public readonly _shallow = false) {
    this._value = _shallow ? _rawValue : convert(_rawValue)
  }

  get value() {
    track(toRaw(this), TrackOpTypes.GET, 'value')
    return this._value
  }

  set value(newVal) {
    if (hasChanged(toRaw(newVal), this._rawValue)) {
      this._rawValue = newVal
      this._value = this._shallow ? newVal : convert(newVal)
      trigger(toRaw(this), TriggerOpTypes.SET, 'value', newVal)
    }
  }
}
```

