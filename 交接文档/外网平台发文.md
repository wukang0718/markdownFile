## 项目地址

> svn://39.106.209.22/repository/repository/trunk/web/jtb-web

## 环境搭建

> ​	使用 `gulp` 工具，项目根目录的 `gulpfile.js` 是 `gulp` 的配置文件

#### 安装依赖

- windows 机器建议使用 `cnpm` 安装，使用 npm 会出现安装失败的情况
- 如果出现压缩图片的模块安装失败，删除 `node_modules` 目录，使用 `cnpm` 重新安装

```bash
cnpm install 
```

#### 开发环境

###### 运行

```bash
npm run dev	
```

-  运行环境用 `express` 框架，运行一个 `3000` 端口的静态资源服务，访问 `dist` 目录资源，自动编译.
- 配置反向代理，使用 `http-proxy-middleware` 模块，在 `gulpfile.js` 中 `serverTask` 函数中配置，用法[参考文档](https://www.npmjs.com/package/http-proxy-middleware)
- 开发环境会监听文件修改自动编译，但不会热部署
- gulp 配置了编译 `less` 语言的插件，开发中可以使用 `less` 进行 css 开发

#### 生产环境

###### 运行

```bash
npm run build	
```

- 项目会打包到 `dist` 文件夹，部署使用整个 `dist` 文件夹即可。
- 注意：
    - `src/plugin/` 目录下的文件不会打包，直接 `copy` 到 `dist` 目录

## 业务开发

> ​	所有业务代码都在 `src` 目录下

#### 目录结构

![目录结构](https://raw.githubusercontent.com/wukang0718/mdImage/master/images/202008/25/105101-971246.png?token=AKCNZHYTQDOSVI2DIHMD6RS7IR6NE)

- css： 公共 css 样式文件
- images： 公共图片资源
- javascript： 公共js 文件
- web： 多个系统的html/css/js/image
- jtb_pc.conf： nginx 配置文件

##### web目录

![web目录](https://raw.githubusercontent.com/wukang0718/mdImage/master/images/202008/25/105410-985202.png?token=AKCNZH445NKHFMZRG4AXQPS7IR6Y6)

- Announncement：消息新闻
- home / Home-Page / Home_Page： 三种风格的登录系统，目前使用 Home-Page 
- publicaApplication：依申请公开系统，**还没有开发**
- publicFile：发文管理系统
- sendRelease：发文发电系统，**还没有开发**
- UA：UA管理系统

#### 使用技术

- jquery
- bootstrap
- layui （主要是在表格中使用）
- 自定义 `jquey`  插件
- bootstrap-fileinput 文件上传
- my97DatePicker 日期插件
- ztree 树形结构展示
- crypto-js 加密

## 特殊值

#### `systemCode`

#### ![image-20200827100237559](https://raw.githubusercontent.com/wukang0718/mdImage/master/images/202008/27/100238-861019.png?token=AKCNZHZ4BHKD5UP72SEVNQS7I4KIA)

再每个系统系统中都需要给 `systenInfo.systemCode` 重新赋值

![image-20200827100422166](https://raw.githubusercontent.com/wukang0718/mdImage/master/images/202008/27/100423-322863.png?token=AKCNZHZ77BNL7RHSSEGGKRC7I4KOS)

`systemCode` 对应数据库 `id`，在 Ua 管理中添加系统后，返回`系统 id` ，作为 `systemCode` 值，设置了这个值之后，值调用 `postMan` 或者 `ajaxUtil.postMan` **（这两个方法完全一样）** 方法的时候，会自动添加到请求参数中

#### 环节名称

![image-20200827124533514](https://raw.githubusercontent.com/wukang0718/mdImage/master/images/202008/27/124534-949860.png?token=AKCNZH4WBNRNX2WKSKBYG227I45K4)

判断当前环节都是写死的环节名称，这个环节名称和后台流程图对应的

#### 公文类型（起草、待办。。。）

在 UA 系统配置模块的时候，配置这个参数

- ​	起草： 1
- 